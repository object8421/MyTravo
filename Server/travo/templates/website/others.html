
{% extends "website/base_index.html" %}
{% block title %}{{user.nickname}}的主页{% endblock %}

{% block content %}

<div class="container" style="background-color:#ffffff;">
  <!-- 个人信息条 -->
 <div class="row" style="background-color:#f5f5f5;margin-bottom:0;">
 <!-- 头像信息框 -->
 <div style="margin-left:20px;margin-top:20px;">
        <table class="table" style="float:left;width:250px;margin-right:50px;">
          <tr>
            <td style="padding:0;">
            {% if user.face_path %}
            <img src="http://travo-user-avatar.oss-cn-hangzhou.aliyuncs.com/{{user.face_path}}" alt="Responsive image" class="img-rounded img-responsive" style="width:100%; height:250px; margin:0;padding:0;border-radius:0;">
            {% else %}
           <img src="../../static/travo/image/avatar_default.jpg" alt="Responsive image" class="img-rounded img-responsive" style="width:100%; height:250px; margin:0;padding:0;border-radius:0;">
            {% endif %}
             </td>
          </tr>
          <tr style="padding:0;">     
          <td align="center" style="padding:0; margin:0;">      
      
        <div style="width:250px;margin:0;padding:0;">
        <div class="btn-group btn-group-justified" style="padding-top:0;padding-bottom:0;">
          

          <a type="button" class="btn btn-primary"  style="border-radius:0;" onclick="javascript:window.location.href='{%url 'show_my_travel' user.id %}' "><p style="font-size:22px;padding-bottom:0;margin-bottom:0;padding-top:0;margin-top:0;">{{user.travel_qty}}</p><p style="font-size:8px;padding-bottom:0;margin-bottom:0;padding-top:0;margin-top:0;">游记</p></a>
          
          <a type="button" class="btn btn-primary" style="border-radius:0;"><p style="font-size:22px;padding-bottom:0;margin-bottom:0;padding-top:0;margin-top:0;">{{followed_list | length}}</p><p style="font-size:8px;padding-bottom:0;margin-bottom:0;padding-top:0;margin-top:0;">关注</p></a>
          <a type="button" class="btn btn-primary"  style="border-radius:0;"><p style="font-size:22px;padding-bottom:0;margin-bottom:0;padding-top:0;margin-top:0;">{{user.follower_qty}}</p><p style="font-size:8px;padding-bottom:0;margin-bottom:0;padding-top:0;margin-top:0;">粉丝</p></a>
          
        </div>
        </div>
  



        </td>
            </tr>
          </table>
      
     </div><!-- 头像 end -->


  <div style="float:left;margin-top:70px;">
  {%if user %}
        <h1>{{user.nickname}}</h1>
        <h3>{{userinfo.sex | default:"男"}}</h3>

        <h4>{{user.signature | default:"暂无个性签名"}}</h4>
        <form id="ChangeFollowForm" role="form">
        <input type="hidden" id="other_id" value={{user.id}}></input>
        {% ifequal is_followed 0 %}
        <button id="btnfollow" type="button"  class="btn btn-primary" >＋关注</button>
        <button id="btnunfollow" type="hidden"  class="btn btn-danger" >-取消关注</button>
        {% else %}
        <button id="btnfollow" type="hidden"  class="btn btn-primary" >＋关注</button>
        <button id="btnunfollow" type="button"  class="btn btn-danger" >-取消关注</button>
        {% endifequal %}
        </form>
  {% endif %}
  </div>



 </div><!-- row end -->


<!-- Here comes the divider -->


<hr class="featurette-divider " style="margin-top:0;">
<div style="padding-bottom:20px;">
  <!-- 游记条题目 -->


<div class="col-md-12" style=" padding-left:5px;margin-bottom:20px;">
<div class="col-md-2" style="padding:0;">
<button type="button" onclick="javascript:window.location.href='{%url 'show_my_travel' user.id%}' " class="btn btn-info btn-lg btn-block" style="border-radius:2px;">游记   <span class="badge"> {{user.travel_qty}}</span></button>  

 
</div>
</div>
<!-- 我的游记 条 从这里开始-->
<div class="row clearfix" align="center">

<!-- 这里是第一篇游记，span1 -->
{%for travel in recent_travel_list %}
  <div  class="col-md-4 column" >

<div class="panel panel-default" style="width:350px;">
  <div class="panel-body"  onclick="javascript:window.location.href='{%url 'detail_travel' travel.id %}' " style="cursor:pointer;">
    {% if travel.cover_path %}
     <img src="ftp://172.16.12.125/image/cover/{{travel.cover_path}}" alt="..." class="img-rounded" style="width:100%; height:250px; margin=0;">
    {% else %}
     <img src="../../static/travo/image/travel_default.jpg" alt="..." class="img-rounded" style="width:100%; height:250px; margin=0;">
    {% endif %}
  </div>
  <div class="panel-footer" align="left">
    <table class="table" style="width:300px;margin:0;padding:0;">
              <tr style="width:300px; padding:0; margin:0;" align="left">
                <div style="float:left;">

                <h5 class="pull-left"><a href="{%url 'detail_travel' travel.id %}">{{travel.title}}</a></h5>
                
              </div>
              

              <div class="btn-group " style="float:right; margin－top:0;" >
                    <button type="button" class="btn btn-link btn-sm" >标签1</button>
                    <button type="button" class="btn btn-link btn-sm" >标签2</button>
                </div>

              <div style="clear:both;">
                <h6 > {{travel.description}} </h6>
              </div>
               
                   
              </tr>
              <tr>
              
              <div style="clear:both; float:left;"><h6>{{travel.create_time}}</h6>
              </div>
              <div style="float:right; padding-right:10px;"><h6>
                <span class="glyphicon glyphicon-heart"></span> {{ travel.vote_qty}}
                <span class="glyphicon glyphicon-comment"></span>{{ travel.favorite_qty}}</h6>
              </div>

              </tr>
            
             </table>
</div>
</div>
</div><!--  这是三分之一的span (1)end-->
{% endfor %}

</div><!-- 游记条end-->


<hr class="featurette-divider">
<div class="col-md-12" style=" padding-left:5px;margin-bottom:20px;">
<div class="col-md-2" style="padding:0;">
<button type="button" class="btn btn-info btn-lg btn-block" style="border-radius:2px;">喜欢的游记   <span class="badge"> {{want_list_length | default:"0"}}</span></button>  
</div>
</div>


<div class="row clearfix" align="center">

<!-- 这里是第一篇游记，span1 -->
{%for travel in favorite_travel_list %}
  <div  class="col-md-4 column" >

<div class="panel panel-default" style="width:350px;">
  <div class="panel-body" onclick="javascript:window.location.href='{%url 'detail_travel' travel.id %}' " style="cursor:pointer;">
     <img src="http://travo-travel-cover.oss-cn-hangzhou.aliyuncs.com/{{travel.cover_path}}" alt="..." class="img-rounded" style="width:100%; height:250px; margin=0;">
    
  </div>
  <div class="panel-footer" align="left">
    <table class="table" style="width:300px;margin:0;padding:0;">
              <tr style="width:300px; padding:0; margin:0;" align="left">
                <div style="float:left;">

                <h5 class="pull-left"><a href="{%url 'detail_travel' travel.id %}">{{travel.title}}</a></h5>
                
              </div>
              

              <div class="btn-group " style="float:right; margin－top:0;" >
                    <button type="button" class="btn btn-link btn-sm" >标签1</button>
                    <button type="button" class="btn btn-link btn-sm" >标签2</button>
                </div>

              <div style="clear:both;">
                <h6 > {{travel.description}} </h6>
              </div>
               
                   
              </tr>
              <tr>
              
              <div style="clear:both; float:left;"><h6>{{travel.create_time | date:"Y-m-d"}}</h6>
              </div>
              <div style="float:right; padding-right:10px;"><h6>
                <span class="glyphicon glyphicon-heart"></span> {{ travel.favorite_qty}}
                <span class="glyphicon glyphicon-comment"></span> {{ travel.comment_qty}}</h6>
              </div>

              </tr>
            
             </table>
</div>
</div>
</div><!--  这是三分之一的span (1)end-->
{% endfor %}

</div><!-- 收藏的游记条end-->






<hr class="featurette-divider">
<div class="col-md-12" style=" padding-left:5px;margin-bottom:20px;">
<div class="col-md-2" style="padding:0;">
<button type="button" class="btn btn-info btn-lg btn-block" style="border-radius:2px;">想去的地方   <span class="badge"> {{want_list_length | default:"0"}}</span></button>  
</div>
</div>





</div>
</div><!-- end of container -->

    {% endblock %}
{% block myscript %}
<script type="text/javascript">
// function follow(action){
  
//   var other_id = $("#other_id").val();
//   var btn = document.getElementById("btnfollow");
//   $.post("/user/change_follow",{'other_id':other_id,'action':action}, function(ret){
//     if(ret == '1'){
//       if(action == 1){
//         btn.innerHTML = "-取消关注";
//         btn.onclick = this(0);
//       }
        
//       else{
//         btn.innerHTML = "+关注";
//         btn.onclick = this(1);
//       }
        
//     }
      
//     else
//       $('#changePasswordFailModal').modal('show');
//   }
//   alert(action);
// }
  $(document).ready(function(){
  {% ifequal is_followed 1 %}
    $('#btnfollow').hide();
  {% else %}
    $('#btnunfollow').hide();
  {% endifequal %}
});
  $('#btnfollow').click(function(){
  var other_id = $("#other_id").val();
  var btn = document.getElementById("btnfollow");
  var action = 1;
  $.post("/user/change_follow",{'other_id':other_id,'action':action}, function(ret){
    if(ret == '1'){
      
        $('#btnunfollow').show();
        $('#btnfollow').hide();
      
    }
      
    else
      alert("关注失败");
  });  
});
  $('#btnunfollow').click(function(){
  var other_id = $("#other_id").val();
  var btn = document.getElementById("btnfollow");
  var action = 0;
  $.post("/user/change_follow",{'other_id':other_id,'action':action}, function(ret){
    if(ret == '1'){
      
        $('#btnfollow').show();
        $('#btnunfollow').hide();
           
    }
      
    else
      alert("取消关注失败");
  });  
});
</script>
{% endblock %}
